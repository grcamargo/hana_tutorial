'use strict';

var format = require('util').format;
var utils = require('../utils');
var MANDATORY_OPTIONS = require('./constants').MANDATORY_OPTIONS;
var DEFAULT_SERVICE = require('./constants').DEFAULT_SERVICE;
var DEFAULT_PLAN = require('./constants').DEFAULT_PLAN;

module.exports = {
  processMainOptions: processMainOptions
};

function processMainOptions(options) {
  MANDATORY_OPTIONS.forEach(function (property) {
    if (!utils.isNonEmptyString(options[property])) {
      throw new Error(format("Property '%s' should be a non-empty string", property));
    }
  });

  ['service', 'plan'].forEach(function (property) {
    if (utils.isDefined(options[property]) && !utils.isNonEmptyString(options[property])) {
      throw new Error(format("Property '%s' should be a non-empty string if provided", property));
    }
  });

  options.service = options.service || DEFAULT_SERVICE;
  options.plan = options.plan || DEFAULT_PLAN;
  return options;
}
